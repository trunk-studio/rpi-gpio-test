#!/usr/bin/env python

###################################
# HME LED DAEMON FOR RASPBERRY PI #
###################################
import sys, os, time
import RPi.GPIO as GPIO
from subprocess import call

GPIO.setwarnings(False) 
GPIO.setmode(GPIO.BCM)

GPIO.setup(18, GPIO.IN)

def pressed(pin):
    i = GPIO.input(18)
    print "pressed"
    f = open('/var/run/hme/led/led1', 'w+')
    f.write('on')
    f.close()


pid = os.fork()

if pid is not 0:
    print "Run hme-reset as daemon."
    sys.exit(0)
else:
    GPIO.add_event_detect(18, GPIO.RISING, callback=pressed, bouncetime=200)

    while True:
       time.sleep(1)
